{% extends "base.html" %}

{% block content %}
<style>
    table {
        width: 100%;
        border-collapse: collapse;
    }
    
    th, td {
        padding: 10px;
        text-align: left;
        border-bottom: 1px solid #ddd;
    }
    
    th {
        background-color: #f2f2f2;
    }
    
    tr:hover {
        background-color: #f5f5f5;
    }
</style>    
<h2>{{ exam.year }}回 国家試験の分野ごとの正答率</h2>

<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>分野</th>
            <th>問題数</th>
            <th>正答数</th>
            <th>正答率 (%)</th>
        </tr>
    </thead>
    <tbody>
        {% for result in field_accuracy %}
        <tr>
            <td>{{ result.question__field__name }}</td>
            <td>{{ result.total }}</td>
            <td>{{ result.correct_sum }}</td>
            <td>{{ result.accuracy|floatformat:2 }}</td>
            <td>
                <div class="progress">
                    <div class="progress-bar" role="progressbar" style="width: {{ result.accuracy }}%;" aria-valuenow="{{ result.accuracy }}" aria-valuemin="0" aria-valuemax="100">{{ result.accuracy|floatformat:2 }}%</div>
                </div>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<canvas id="myFieldAccuracyChart" width="400" height="400"></canvas>

<p><a href="{% url 'pt_kokushi:kokushi_results' %}" class="btn btn-secondary">成績に戻る</a></p>
<p><a href="{% url 'pt_kokushi:top' %}" class="btn btn-secondary">トップに戻る</a></p>

<script>
    var ctx = document.getElementById('myFieldAccuracyChart').getContext('2d');
    var myFieldAccuracyChart = new Chart(ctx, {
    type: 'pie', // 円グラフのタイプ
    data: {
        labels: ['分野1', '分野2', '分野3'], // 各分野の名前
        datasets: [{
            data: [20, 30, 50], // 各分野の正答数の割合
            backgroundColor: [
                'rgba(255, 99, 132, 0.2)',
                'rgba(54, 162, 235, 0.2)',
                'rgba(255, 206, 86, 0.2)',
            ],
            borderColor: [
                'rgba(255, 99, 132, 1)',
                'rgba(54, 162, 235, 1)',
                'rgba(255, 206, 86, 1)',
            ],
            borderWidth: 1
        }]
    },
    options: {
        title: {
            display: true,
            text: '各分野の正答数の割合'
        }
    }
});
</script>
    
{% endblock %}
